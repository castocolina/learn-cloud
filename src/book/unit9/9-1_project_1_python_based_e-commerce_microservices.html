<div class="topic-content">
    <header class="topic-header" aria-label="Header">
        <h1 class="topic-title">Unit 9.1: Project 1: Python-based E-Commerce Microservices</h1>
        <p class="topic-intro">Build a comprehensive multi-service backend for an e-commerce application, integrating key technologies including Python, FastAPI, Kubernetes, Terraform, and Vault to create a robust, scalable, and secure system.</p>
    </header>

    <section class="project-overview">
        <h2><i class="bi bi-briefcase"></i> Project Brief</h2>
        <p class="lead">
            Build a multi-service backend for an e-commerce application. This project will integrate the key technologies from
            this course, including Python, FastAPI, Kubernetes, Terraform, and Vault, to create a robust, scalable, and secure
            system.
        </p>

        <h3>Core Services to Build:</h3>
        <ol>
            <li>
                <strong>Product Service (FastAPI):</strong>
                <ul>
                    <li>A RESTful API for managing products.</li>
                    <li>Endpoints: <code>POST /products</code>, <code>GET /products/{id}</code>, <code>GET /products</code>.</li>
                    <li>Data Store: PostgreSQL database, accessed via SQLAlchemy.</li>
                </ul>
            </li>
            <li>
                <strong>Order Service (FastAPI):</strong>
                <ul>
                    <li>A RESTful API for creating and retrieving orders.</li>
                    <li>Endpoint: <code>POST /orders</code> (should take a list of product IDs and quantities).</li>
                    <li>Upon receiving an order, it publishes an `OrderCreated` event to a message queue.</li>
                    <li>Data Store: PostgreSQL database.</li>
                </ul>
            </li>
            <li>
                <strong>Payment Worker (Python):</strong>
                <ul>
                    <li>A background service that consumes `OrderCreated` events from the message queue.</li>
                    <li>Simulates payment processing (e.g., with a <code>time.sleep()</code>).</li>
                    <li>Updates the order status in the Order Service's database upon completion.</li>
                </ul>
            </li>
        </ol>
    </section>

    <section class="architecture-section">
        <h2>Technical Requirements &amp; Architecture</h2>
        <div class="text-center my-4">
            <pre class="mermaid">
  <script type="text/plain">
    graph LR
            User["User"] --> Ingress["Kubernetes Ingress"];
            Ingress --> ProductAPI["Product Service (FastAPI)"];
            Ingress --> OrderAPI["Order Service (FastAPI)"];

            ProductAPI <--> ProductDB[(PostgreSQL)];
            OrderAPI <--> OrderDB[(PostgreSQL)];
            OrderAPI -- "Publishes 'OrderCreated' Event" --> MQ[Message Queue];
            MQ -- "Delivers Event" --> PaymentWorker["Payment Worker"];
            PaymentWorker -- "Updates Order Status" --> OrderDB;

            subgraph "Secrets Management"
              Vault[HashiCorp Vault] -- "Injects DB Credentials" --> ProductAPI;
              Vault -- "Injects DB Credentials" --> OrderAPI;
              Vault -- "Injects DB Credentials" --> PaymentWorker;
            end

            subgraph "Infrastructure (Managed by Terraform)"
              direction TB
              Cluster["EKS Cluster"];
              ProductDB;
              OrderDB;
              MQ;
              Vault;
            end
  </script>
</pre>
            <small class="text-muted">Diagram: Target Architecture for the Python Capstone Project</small>
        </div>

        <ul>
            <li>
                <strong>Infrastructure as Code:</strong>
                <ul>
                    <li>
                        Use <strong>Terraform</strong> to provision all necessary AWS infrastructure, including an EKS cluster, RDS
                        for PostgreSQL databases, and a message queue service (e.g., Amazon MQ or a self-hosted RabbitMQ).
                    </li>
                </ul>
            </li>
            <li>
                <strong>Containerization &amp; Orchestration:</strong>
                <ul>
                    <li>Each service must be containerized using a multi-stage <strong>Dockerfile</strong>.</li>
                    <li>
                        All services must be deployed to the EKS cluster using <strong>Kubernetes manifests</strong> (Deployments,
                        Services, etc.).
                    </li>
                </ul>
            </li>
            <li>
                <strong>Secrets Management:</strong>
                <ul>
                    <li>Use <strong>HashiCorp Vault</strong> to manage database credentials.</li>
                    <li>
                        Integrate Vault with Kubernetes using the Vault Agent Injector to securely provide credentials to the
                        services at runtime.
                    </li>
                </ul>
            </li>
            <li>
                <strong>CI/CD:</strong>
                <ul>
                    <li>Create a <strong>GitHub Actions</strong> workflow that automates:</li>
                    <li>Linting (Ruff) and testing (Pytest).</li>
                    <li>Building and pushing Docker images to a registry.</li>
                    <li>(Bonus) Automatically deploying to Kubernetes upon a merge to the `main` branch.</li>
                </ul>
            </li>
        </ul>
    </section>

    <section class="implementation-guide">
        <h2>Implementation Steps</h2>
        <div class="step-cards">
            <div class="step-card">
                <h4>Step 1: Service Development</h4>
                <ul>
                    <li>Implement Product Service with FastAPI and SQLAlchemy</li>
                    <li>Implement Order Service with message queue integration</li>
                    <li>Develop Payment Worker with event consumption</li>
                    <li>Write comprehensive unit tests with Pytest</li>
                </ul>
            </div>

            <div class="step-card">
                <h4>Step 2: Infrastructure Setup</h4>
                <ul>
                    <li>Create Terraform modules for EKS cluster</li>
                    <li>Provision RDS PostgreSQL instances</li>
                    <li>Set up message queue service (RabbitMQ or Amazon MQ)</li>
                    <li>Configure HashiCorp Vault for secrets management</li>
                </ul>
            </div>

            <div class="step-card">
                <h4>Step 3: Containerization</h4>
                <ul>
                    <li>Write multi-stage Dockerfiles for each service</li>
                    <li>Create Kubernetes manifests (Deployments, Services, Ingress)</li>
                    <li>Configure Vault Agent Injector integration</li>
                    <li>Test local deployment with Docker Compose</li>
                </ul>
            </div>

            <div class="step-card">
                <h4>Step 4: CI/CD Pipeline</h4>
                <ul>
                    <li>Set up GitHub Actions workflows</li>
                    <li>Integrate security scanning (Bandit, pip-audit, Trivy)</li>
                    <li>Configure automated testing and deployment</li>
                    <li>Implement blue-green or rolling deployment strategy</li>
                </ul>
            </div>
        </div>
    </section>

    <section class="deliverables">
        <h2>Project Deliverables</h2>
        <div class="deliverable-grid">
            <div class="deliverable-item">
                <h4>üìù Source Code</h4>
                <p>Complete Python services with comprehensive test coverage</p>
            </div>
            <div class="deliverable-item">
                <h4>üèóÔ∏è Infrastructure Code</h4>
                <p>Terraform modules for AWS infrastructure provisioning</p>
            </div>
            <div class="deliverable-item">
                <h4>üìã Kubernetes Manifests</h4>
                <p>Production-ready deployment configurations</p>
            </div>
            <div class="deliverable-item">
                <h4>üîÑ CI/CD Pipeline</h4>
                <p>Automated GitHub Actions workflows with security integration</p>
            </div>
            <div class="deliverable-item">
                <h4>üìö Documentation</h4>
                <p>API documentation, deployment guide, and architecture overview</p>
            </div>
            <div class="deliverable-item">
                <h4>üöÄ Live Demo</h4>
                <p>Running application deployed to cloud infrastructure</p>
            </div>
        </div>
    </section>

    <section class="success-metrics">
        <h2>Success Criteria</h2>
        <div class="metrics-list">
            <div class="metric-item">
                <i class="bi bi-check-circle-fill"></i>
                <span>All services successfully deployed to Kubernetes</span>
            </div>
            <div class="metric-item">
                <i class="bi bi-check-circle-fill"></i>
                <span>End-to-end order flow working (Product ‚Üí Order ‚Üí Payment)</span>
            </div>
            <div class="metric-item">
                <i class="bi bi-check-circle-fill"></i>
                <span>Secrets managed securely through HashiCorp Vault</span>
            </div>
            <div class="metric-item">
                <i class="bi bi-check-circle-fill"></i>
                <span>CI/CD pipeline with security scanning operational</span>
            </div>
            <div class="metric-item">
                <i class="bi bi-check-circle-fill"></i>
                <span>90%+ test coverage for all services</span>
            </div>
            <div class="metric-item">
                <i class="bi bi-check-circle-fill"></i>
                <span>Infrastructure fully provisioned via Terraform</span>
            </div>
        </div>
    </section>

    <section class="bonus-challenges">
        <h2>Bonus Challenges</h2>
        <div class="challenge-list">
            <div class="challenge-item">
                <h4>üîç Observability Stack</h4>
                <p>Implement Prometheus metrics, Grafana dashboards, and distributed tracing</p>
            </div>
            <div class="challenge-item">
                <h4>üîí Advanced Security</h4>
                <p>Implement service mesh (Istio) with mutual TLS and network policies</p>
            </div>
            <div class="challenge-item">
                <h4>üìä Performance Testing</h4>
                <p>Load testing with k6 and performance optimization</p>
            </div>
            <div class="challenge-item">
                <h4>üåä Event Streaming</h4>
                <p>Replace message queue with Kafka for event streaming architecture</p>
            </div>
        </div>
    </section>
</div>